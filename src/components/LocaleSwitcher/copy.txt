'use client';

import { useRouter } from 'next/navigation';
import { useLocale } from 'next-intl';
import { usePathname, useSearchParams } from 'next/navigation';
import { ChangeEvent, useTransition } from 'react';

const LocaleSwitcher = () => {
  const [isPending, startTransition] = useTransition();
  const router = useRouter();
//   const localeActive = useLocale();
  const pathname = usePathname();
  const searchParams = useSearchParams();

  const onSelectChange = (e: ChangeEvent<HTMLSelectElement>) => {
    const nextLocale = e.target.value;
    
    // Construct the new URL with the next locale
    const newPathname = `/${nextLocale}${pathname.replace(/^\/[a-z]{2}/, '')}`;
    const newSearchParams = searchParams.toString();
    const newUrl = `${newPathname}${newSearchParams ? '?' + newSearchParams : ''}`;
    
    startTransition(() => {
      router.replace(newUrl);
    });
  };

  return (
    <label className="border-2 rounded">
      <p className="sr-only">Change Language</p>
      <select
        // defaultValue={localeActive}
        disabled={isPending}
        onChange={onSelectChange}
        className="bg-transparent text-white px-2 py-1"
      >
        <option value="en">English</option>
        <option value="sv">Swedish</option>
      </select>
    </label>
  );
};


export default LocaleSwitcher;

'use client';

import { useRouter } from 'next/navigation';
import { usePathname, useSearchParams } from 'next/navigation';
import { useState, useTransition } from 'react';
import Image from 'next/image';
import Sweden from "../../../public/images/sweden.png";
import English from "../../../public/images/circle.png"; 
import Denmark from "../../../public/images/denmark.png"
import Norway from "../../../public/images/norway.png"
import Finland from "../../../public/images/finland.png"
import Sweden1 from "../../../public/images/sweden1.png"
import Denmark1 from "../../../public/images/denmark1.png"
import Norway1 from "../../../public/images/norway1.png"
import Finland1 from "../../../public/images/finland1.png"
import England1 from "../../../public/images/unoitedKingdom.png"

const LocaleSwitcher = () => {
    const [isPending, startTransition] = useTransition();
    const [dropdownOpen, setDropdownOpen] = useState(false);
    const [selectedLocale, setSelectedLocale] = useState('se'); // default to English
    const router = useRouter();
    const pathname = usePathname();
    const searchParams = useSearchParams();

    
    const onSelectChange = (nextLocale: string) => {
    setSelectedLocale(nextLocale);
  
      // Construct the new URL with the next locale
      const newPathname = `/${nextLocale}${pathname.replace(/^\/[a-z]{2}/, '')}`;
      const newSearchParams = searchParams.toString();
      const newUrl = `${newPathname}${newSearchParams ? '?' + newSearchParams : ''}`;
      
      startTransition(() => {
        router.replace(newUrl);
      });
  
      // Close dropdown
      setDropdownOpen(false);
    };
  
    const toggleDropdown = () => {
      setDropdownOpen(!dropdownOpen);
    };
  
    // Get the flag image based on the selected locale
    const getFlagImage = (locale: string) => {
      switch (locale) {
        case 'sv':
          return Sweden;
        case 'da':
          return Denmark;
        case 'no':
          return Norway;
        case 'fi':
          return Finland;
        case 'en':
        default:
          return English;
      }
    };
  
    return (
      <div className="relative">
        <button onClick={toggleDropdown} className="rounded bg-transparent text-white px-4 py-1 flex items-center">
          <Image src={getFlagImage(selectedLocale)} alt={selectedLocale} width={30} height={30} />
        </button>
        {dropdownOpen && (
          <ul className="absolute rounded mt-3 ml-2 items-center">
            
            <li onClick={() => onSelectChange('sv')} className="flex items-center p-2 cursor-pointer">
              <Image src={Sweden1} alt='Swedish' width={30} height={30} className="mr-2" /> Swedish
            </li>
            <li onClick={() => onSelectChange('da')} className="flex items-center p-2 cursor-pointer">
              <Image src={Denmark1} alt='Danish' width={30} height={30} className="mr-2" /> Danish
            </li>
            <li onClick={() => onSelectChange('no')} className="flex items-center p-2 cursor-pointer">
              <Image src={Norway1} alt='Norwegian' width={30} height={30} className="mr-2" />Norwegian
            </li>
            <li onClick={() => onSelectChange('fi')} className="flex items-center p-2 cursor-pointer">
              <Image src={Finland1} alt='Finnish' width={30} height={30} className="mr-2" />Finnish
            </li>
            <li onClick={() => onSelectChange('en')} className="flex items-center p-2 cursor-pointer">
              <Image src={England1} alt='English' width={30} height={30} className="mr-2" />English
            </li>
          </ul>
        )}
      </div>
    );
  };
  
  export default LocaleSwitcher;


'use client';

import { useRouter } from 'next/navigation';
import { usePathname, useSearchParams } from 'next/navigation';
import { useState, useTransition, ChangeEvent } from 'react';
import Image from 'next/image';
import Sweden from '../../../public/images/sweden.png';
import English from '../../../public/images/circle.png';
import Denmark from '../../../public/images/denmark.png';
import Norway from '../../../public/images/norway.png';
import Finland from '../../../public/images/finland.png';

const LocaleSwitcher = () => {
  const [isPending, startTransition] = useTransition();
  const [selectedLocale, setSelectedLocale] = useState('se'); // default to English
  const router = useRouter();
  const pathname = usePathname();
  const searchParams = useSearchParams();

  const onSelectChange = (e: ChangeEvent<HTMLSelectElement>) => {
    const nextLocale = e.target.value;
    setSelectedLocale(nextLocale);

    // Construct the new URL with the next locale
    const newPathname = `/${nextLocale}${pathname.replace(/^\/[a-z]{2}/, '')}`;
    const newSearchParams = searchParams.toString();
    const newUrl = `${newPathname}${
      newSearchParams ? '?' + newSearchParams : ''
    }`;

    startTransition(() => {
      router.replace(newUrl);
    });
  };

  // Get the flag image based on the selected locale
  const getFlagImage = (locale: string) => {
    if (locale === 'sv') {
      return Sweden;
    } else if (locale === 'da') {
      return Denmark;
    } else if (locale === 'no') {
      return Norway;
    } else if (locale === 'fi') {
      return Finland;
    } else if (locale === 'en') {
      return English;
    } else {
      return Sweden; // Default to Swedish if locale is not recognized
    }
  };

  return (
    <div className="relative">
      <div className="rounded bg-transparent text-white px-4 py-1 flex items-center">
        <Image
          src={getFlagImage(selectedLocale)}
          alt={selectedLocale}
          width={40}
          height={40}
        />
      </div>
      <select
        value={selectedLocale}
        onChange={onSelectChange}
        className="absolute top-full mt-1 ml-2 bg-gray-800 text-white p-2 rounded"
      >
        <option value="en">English</option>
        <option value="se">Swedish</option>
        <option value="da">Danish</option>
        <option value="no">Norwegian</option>
        <option value="fi">Finnish</option>
      </select>
    </div>
  );
};

export default LocaleSwitcher;